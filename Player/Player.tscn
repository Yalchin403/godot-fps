[gd_scene load_steps=28 format=2]

[ext_resource path="res://Player/Player.gd" type="Script" id=1]
[ext_resource path="res://characters/CharacherMover.gd" type="Script" id=2]
[ext_resource path="res://characters/HealthManager.gd" type="Script" id=3]
[ext_resource path="res://Player/WeaponManager.gd" type="Script" id=4]
[ext_resource path="res://weapons/raw_assets/shotgun.glb" type="PackedScene" id=5]
[ext_resource path="res://weapons/raw_assets/machinegun.glb" type="PackedScene" id=6]
[ext_resource path="res://weapons/raw_assets/machete.glb" type="PackedScene" id=7]
[ext_resource path="res://weapons/raw_assets/rocketlauncher.glb" type="PackedScene" id=8]
[ext_resource path="res://weapons/HitScanBulletEmitter.tscn" type="PackedScene" id=9]
[ext_resource path="res://weapons/Weapon.gd" type="Script" id=10]
[ext_resource path="res://effects/MuzzleFlash.gd" type="Script" id=11]
[ext_resource path="res://effects/raw_assets/muzzleflash1.glb" type="PackedScene" id=12]
[ext_resource path="res://effects/raw_assets/muzzleflash3.glb" type="PackedScene" id=13]
[ext_resource path="res://weapons/DamageArea.tscn" type="PackedScene" id=14]

[sub_resource type="Animation" id=3]
length = 0.001
tracks/0/type = "value"
tracks/0/path = NodePath("..:translation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( 0, 0, 0 ) ]
}
tracks/1/type = "value"
tracks/1/path = NodePath("..:rotation_degrees")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( -7.46219e-07, 0, 0 ) ]
}
tracks/2/type = "value"
tracks/2/path = NodePath(".:translation")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( -3.65, 2.5, -6.60001 ) ]
}
tracks/3/type = "value"
tracks/3/path = NodePath(".:rotation_degrees")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( 15.9964, -70.2804, -11.4331 ) ]
}

[sub_resource type="Animation" id=4]
resource_name = "attack"
tracks/0/type = "value"
tracks/0/path = NodePath(".:translation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0, 0.1, 0.2 ),
"transitions": PoolRealArray( 1, 1, 1 ),
"update": 0,
"values": [ Vector3( -3.65, 2.5, -6.60001 ), Vector3( -3.65, 2.5, -6.60001 ), Vector3( -3.65, 2.49999, -6.60001 ) ]
}
tracks/1/type = "value"
tracks/1/path = NodePath(".:rotation_degrees")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0, 0.1, 0.2 ),
"transitions": PoolRealArray( 1, 1, 1 ),
"update": 0,
"values": [ Vector3( 33.6681, -83.7846, -20.1801 ), Vector3( -74.6586, 78.587, -154.201 ), Vector3( -0.106842, -73.4719, -5.15838 ) ]
}

[sub_resource type="Animation" id=2]
resource_name = "idle"
tracks/0/type = "value"
tracks/0/path = NodePath("..:translation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( 0, 0, 0 ) ]
}
tracks/1/type = "value"
tracks/1/path = NodePath("..:rotation_degrees")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( -7.46219e-07, 0, 0 ) ]
}

[sub_resource type="Animation" id=5]
length = 0.001
tracks/0/type = "value"
tracks/0/path = NodePath(".:translation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( 0, 0, 0 ) ]
}
tracks/1/type = "value"
tracks/1/path = NodePath(".:rotation_degrees")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( 0, 0, 0 ) ]
}
tracks/2/type = "value"
tracks/2/path = NodePath("machinegun:translation")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( -3.86924, 0.666214, -5.89736 ) ]
}
tracks/3/type = "value"
tracks/3/path = NodePath("machinegun:rotation_degrees")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( 7.43201, 180, 1.34532e-06 ) ]
}

[sub_resource type="Animation" id=6]
resource_name = "attack"
length = 0.2
tracks/0/type = "value"
tracks/0/path = NodePath("machinegun:translation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0, 0.2 ),
"transitions": PoolRealArray( 1, 1 ),
"update": 0,
"values": [ Vector3( -3.86923, 0.666212, -5.89732 ), Vector3( -3.87538, 0.679168, -5.69783 ) ]
}

[sub_resource type="Animation" id=7]
resource_name = "idle"
tracks/0/type = "value"
tracks/0/path = NodePath(".:translation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( 0, 0, 0 ) ]
}
tracks/1/type = "value"
tracks/1/path = NodePath(".:rotation_degrees")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( 0, 0, 0 ) ]
}

[sub_resource type="Animation" id=8]
length = 0.001
tracks/0/type = "value"
tracks/0/path = NodePath(".:translation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( 0, 0, 0 ) ]
}

[sub_resource type="Animation" id=9]
resource_name = "attack"
length = 0.2
tracks/0/type = "value"
tracks/0/path = NodePath(".:translation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0, 0.1 ),
"transitions": PoolRealArray( 1, 1 ),
"update": 0,
"values": [ Vector3( 0.0307655, -0.0647812, -0.997429 ), Vector3( 0, -9.53674e-07, 0 ) ]
}

[sub_resource type="Animation" id=10]
resource_name = "idle"
tracks/0/type = "value"
tracks/0/path = NodePath(".:translation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( 0, 0, 0 ) ]
}

[sub_resource type="Animation" id=11]
length = 0.001
tracks/0/type = "value"
tracks/0/path = NodePath(".:translation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( 0, 0, 0 ) ]
}
tracks/1/type = "value"
tracks/1/path = NodePath(".:rotation_degrees")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( -1.18228e-06, 3.20165e-07, 0 ) ]
}
tracks/2/type = "value"
tracks/2/path = NodePath("rocketlauncher:translation")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( -1.09953, -0.197994, -1.53069 ) ]
}

[sub_resource type="Animation" id=12]
resource_name = "attack"
tracks/0/type = "value"
tracks/0/path = NodePath("rocketlauncher:translation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0, 0.4 ),
"transitions": PoolRealArray( 1, 1 ),
"update": 0,
"values": [ Vector3( -1.09953, -0.197994, -1.53069 ), Vector3( -1.13029, -0.133214, -0.533241 ) ]
}

[sub_resource type="Animation" id=13]
resource_name = "idle"
tracks/0/type = "value"
tracks/0/path = NodePath(".:translation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0.2 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( 0, 0, 0 ) ]
}
tracks/1/type = "value"
tracks/1/path = NodePath(".:rotation_degrees")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0.2 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Vector3( -1.18228e-06, 3.20165e-07, 0 ) ]
}

[sub_resource type="CapsuleShape" id=1]
radius = 0.5
height = 1.0059

[node name="Player" type="KinematicBody"]
transform = Transform( -0.0307654, 0, 0.999527, 0, 1, 0, -0.999527, 0, -0.0307654, -73.4043, -0.781036, 36.0079 )
collision_layer = 6
collision_mask = 3
script = ExtResource( 1 )

[node name="Camera" type="Camera" parent="."]
transform = Transform( -0.977739, 0.0986516, -0.185183, 0.0829793, 0.992427, 0.0905717, 0.192716, 0.0731891, -0.978521, 0.242687, 0.911899, 0.0916672 )
current = true

[node name="WeaponManager" type="Spatial" parent="Camera"]
transform = Transform( -0.97774, 0.0829793, 0.192716, 0.0986517, 0.992427, 0.0731891, -0.185184, 0.0905717, -0.978522, 0.143978, -0.935645, 0.0520325 )
script = ExtResource( 4 )

[node name="Weapons" type="Spatial" parent="Camera/WeaponManager"]
transform = Transform( 1, 1.06581e-14, 0, 0, 1, 1.9873e-14, 0, -1.11022e-16, 1, 0.832764, 0.542619, 0.649658 )

[node name="Machete" type="Spatial" parent="Camera/WeaponManager/Weapons"]
transform = Transform( 1, -2.09548e-09, 0, 0, 0.997898, -0.064811, 0, 0.0648109, 0.997896, 2.87915, -2.88675, 6.29067 )
script = ExtResource( 10 )

[node name="Graphics" type="Spatial" parent="Camera/WeaponManager/Weapons/Machete"]
transform = Transform( 1, 0, 0, 0, 0.999999, 1.3024e-08, 0, -1.3024e-08, 1, 0, 0, 0 )

[node name="machete" parent="Camera/WeaponManager/Weapons/Machete/Graphics" instance=ExtResource( 7 )]
transform = Transform( 0.0916949, -0.0359248, -0.215767, -0.0457218, 0.180637, -0.065709, 0.216972, 0.0532473, 0.077339, -3.65, 2.5, -6.60001 )

[node name="AnimationPlayer" type="AnimationPlayer" parent="Camera/WeaponManager/Weapons/Machete"]
root_node = NodePath("../Graphics/machete")
anims/RESET = SubResource( 3 )
anims/attack = SubResource( 4 )
anims/idle = SubResource( 2 )

[node name="BulletEmitters" type="Spatial" parent="Camera/WeaponManager/Weapons/Machete"]
transform = Transform( 1, 0, 0, 0, 1, 1.79716e-09, 0, -5.50062e-09, 1, 0.307657, -0.647807, -9.97426 )

[node name="DamageArea" parent="Camera/WeaponManager/Weapons/Machete/BulletEmitters" instance=ExtResource( 14 )]

[node name="MachineGun" type="Spatial" parent="Camera/WeaponManager/Weapons"]
transform = Transform( 1, -2.32831e-10, 0, 3.55271e-15, 0.997898, -0.064811, 0, 0.0648108, 0.997896, 2.87915, -1.88675, 6.29073 )
visible = false
script = ExtResource( 10 )
automatic = true

[node name="Graphics" type="Spatial" parent="Camera/WeaponManager/Weapons/MachineGun"]

[node name="machinegun" parent="Camera/WeaponManager/Weapons/MachineGun/Graphics" instance=ExtResource( 6 )]
transform = Transform( -1, 1.21721e-08, -8.66883e-08, 2.3283e-08, 0.991591, -0.12935, 8.43856e-08, -0.129349, -0.991599, -3.86924, 0.666214, -5.89736 )

[node name="MuzzleFlash" type="Spatial" parent="Camera/WeaponManager/Weapons/MachineGun/Graphics"]
script = ExtResource( 11 )

[node name="muzzleflash1" parent="Camera/WeaponManager/Weapons/MachineGun/Graphics/MuzzleFlash" instance=ExtResource( 12 )]
transform = Transform( -0.598864, -0.00239153, -0.0368236, -0.0023917, -0.594962, 0.077536, -0.0368229, 0.0775357, 0.593827, -3.875, 1.23, -4.24206 )

[node name="AnimationPlayer" type="AnimationPlayer" parent="Camera/WeaponManager/Weapons/MachineGun"]
root_node = NodePath("../Graphics")
anims/RESET = SubResource( 5 )
anims/attack = SubResource( 6 )
anims/idle = SubResource( 7 )

[node name="BulletEmitters" type="Spatial" parent="Camera/WeaponManager/Weapons/MachineGun"]
transform = Transform( 1, 2.32831e-10, 0, 0, 1, 1.79716e-09, 0, -1.29949e-08, 1, 0, 0, 7.62939e-06 )

[node name="HitScanBulletEmitter" parent="Camera/WeaponManager/Weapons/MachineGun/BulletEmitters" instance=ExtResource( 9 )]

[node name="Shotgun" type="Spatial" parent="Camera/WeaponManager/Weapons"]
transform = Transform( 1, -1.86265e-09, 0, -7.10543e-15, 0.997898, -0.064811, 0, 0.0648108, 0.997896, 2.87915, -0.88675, 6.29068 )
visible = false
script = ExtResource( 10 )
attack_rate = 0.8

[node name="Graphics" type="Spatial" parent="Camera/WeaponManager/Weapons/Shotgun"]
transform = Transform( 1, -9.31323e-10, 0, 0, 1, 1.78989e-09, -1.86265e-09, -2.82671e-08, 1, 0, 0, 0 )

[node name="shotgun" parent="Camera/WeaponManager/Weapons/Shotgun/Graphics" instance=ExtResource( 5 )]
transform = Transform( -0.950808, 3.31784e-08, -6.22123e-07, -5.79748e-08, 0.942809, -0.122986, 3.72529e-08, -0.122986, -0.942819, -3.79855, 0.131322, -5.65963 )

[node name="MuzzleFlash" type="Spatial" parent="Camera/WeaponManager/Weapons/Shotgun/Graphics"]
script = ExtResource( 11 )

[node name="muzzleflash3" parent="Camera/WeaponManager/Weapons/Shotgun/Graphics/MuzzleFlash" instance=ExtResource( 13 )]
transform = Transform( 1, -3.0268e-09, 0, 0, 0.999998, 3.92683e-08, 0, -1.47542e-07, 0.999999, -3.8, 0.5, -3 )

[node name="AnimationPlayer" type="AnimationPlayer" parent="Camera/WeaponManager/Weapons/Shotgun"]
root_node = NodePath("../Graphics")
anims/RESET = SubResource( 8 )
anims/attack = SubResource( 9 )
anims/idle = SubResource( 10 )

[node name="BulletEmitters" type="Spatial" parent="Camera/WeaponManager/Weapons/Shotgun"]
transform = Transform( 1, -9.31323e-10, 0, 0, 1, 9.51695e-09, 0, -1.30749e-08, 1, 0.0615311, -0.12956, -1.99485 )

[node name="HitScanBulletEmitter" parent="Camera/WeaponManager/Weapons/Shotgun/BulletEmitters" instance=ExtResource( 9 )]

[node name="HitScanBulletEmitter2" parent="Camera/WeaponManager/Weapons/Shotgun/BulletEmitters" instance=ExtResource( 9 )]
transform = Transform( 0.999048, 0, -0.0436194, 0, 1, 0, 0.0436194, 0, 0.999048, 0, 0, 0 )

[node name="HitScanBulletEmitter3" parent="Camera/WeaponManager/Weapons/Shotgun/BulletEmitters" instance=ExtResource( 9 )]
transform = Transform( 0.999048, 0, 0.0436194, 0, 1, 0, -0.0436194, 0, 0.999048, 0, 0, 0 )

[node name="HitScanBulletEmitter4" parent="Camera/WeaponManager/Weapons/Shotgun/BulletEmitters" instance=ExtResource( 9 )]
transform = Transform( 0.996195, 0, -0.0871557, 0, 1, 0, 0.0871557, 0, 0.996195, 0, 0, 0 )

[node name="HitScanBulletEmitter5" parent="Camera/WeaponManager/Weapons/Shotgun/BulletEmitters" instance=ExtResource( 9 )]
transform = Transform( 0.996195, 0, 0.0871557, 0, 1, 0, -0.0871557, 0, 0.996195, 0, 0, 0 )

[node name="RocketLauncher" type="Spatial" parent="Camera/WeaponManager/Weapons"]
transform = Transform( 1, 6.0536e-09, 1.86265e-08, -5.32907e-15, 0.997898, -0.064811, 0, 0.0648106, 0.997894, -0.455456, -0.0791187, 3.35066 )
visible = false

[node name="Graphics" type="Spatial" parent="Camera/WeaponManager/Weapons/RocketLauncher"]
transform = Transform( 1, -1.15305e-16, 5.58793e-09, 0, 1, 2.06347e-08, -5.58793e-09, -2.06347e-08, 1, 0, 0, 0 )

[node name="rocketlauncher" parent="Camera/WeaponManager/Weapons/RocketLauncher/Graphics" instance=ExtResource( 8 )]
transform = Transform( 0.898616, 0.0803969, 0.455968, -0.109625, 1.00416, 0.0389906, -0.44984, -0.0841092, 0.901368, -1.09953, -0.197994, -1.53069 )

[node name="AnimationPlayer" type="AnimationPlayer" parent="Camera/WeaponManager/Weapons/RocketLauncher"]
root_node = NodePath("../Graphics")
anims/RESET = SubResource( 11 )
anims/attack = SubResource( 12 )
anims/idle = SubResource( 13 )

[node name="test_weapon_animations" type="Timer" parent="Camera/WeaponManager"]

[node name="FirePoint" type="Spatial" parent="Camera"]
transform = Transform( 1, 7.45058e-09, -1.49012e-08, -1.41561e-07, 1, -1.75089e-07, 2.98023e-07, 1.86265e-09, 1, 0.73, -0.9, -2.345 )

[node name="CharacherMover" type="Spatial" parent="."]
script = ExtResource( 2 )
move_accel = 1
max_speed = 7

[node name="CollisionShape" type="CollisionShape" parent="."]
transform = Transform( -0.816758, 0.543444, 0.193842, 0.11882, -0.170336, 0.978196, 0.564613, 0.821982, 0.0745511, 0.0319748, 0, -0.0389099 )
shape = SubResource( 1 )

[node name="HealthManager" type="Spatial" parent="."]
script = ExtResource( 3 )

[node name="test_hurt" type="Timer" parent="."]
wait_time = 3.0

[node name="test_heal" type="Timer" parent="."]

[node name="test_gun_unlocker" type="Timer" parent="."]
one_shot = true

[connection signal="fired" from="Camera/WeaponManager/Weapons/MachineGun" to="Camera/WeaponManager/Weapons/MachineGun/Graphics/MuzzleFlash" method="flash"]
[connection signal="fired" from="Camera/WeaponManager/Weapons/Shotgun" to="Camera/WeaponManager/Weapons/Shotgun/Graphics/MuzzleFlash" method="flash"]
[connection signal="timeout" from="Camera/WeaponManager/test_weapon_animations" to="Camera/WeaponManager" method="animate_weapon"]
[connection signal="timeout" from="test_hurt" to="." method="hurt" binds= [ 30, Vector3( 0, 0, 0 ) ]]
[connection signal="timeout" from="test_heal" to="." method="heal" binds= [ 10 ]]
[connection signal="timeout" from="test_gun_unlocker" to="." method="unlock_weapon_slot" binds= [ 4 ]]
